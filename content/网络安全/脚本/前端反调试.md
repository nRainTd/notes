---
创建: "2025-09-29"
tags: 
---

```js
const canvas = document.getElementById('blackHoleCanvas');
const ctx = canvas.getContext('2d');
const centerImage = new Image();
centerImage.src = '/img/php.png';
const imageSizeX = 180;
const imageSizeY = 135;
function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

const screenCenterX = window.screen.width / 2;
const screenCenterY = window.screen.height / 2;

const blackHoleRadius = 100;
const glowRadius = 45;
const particles = [];
const particleCount = 200;
let initialOrbitRadius = 200;

let lastHoleX = 0;
let lastHoleY = 0;
let lastScreenX = window.screenX;
let lastScreenY = window.screenY;

window.addEventListener('mousemove', () => {
  if (window.screenX !== lastScreenX || window.screenY !== lastScreenY) {
    lastScreenX = window.screenX;
    lastScreenY = window.screenY;
  }
});

class Particle {
  constructor() {
    this.angle = Math.random() * Math.PI * 2;
    this.radius = initialOrbitRadius + Math.random() * 30;
    this.size = 1 + Math.random() * 3;
    this.color = 'rgba(255, 255, 255, 0.9)';
    this.rotationSpeed = 0.003 + Math.random() * 0.006;
    this.radiusDecay = 0.01 + Math.random() * 0.2;
    this.trail = [];
    this.trailLength = 30;
    this.relativeTrail = [];
  }

  update() {
    this.angle += this.rotationSpeed;
    this.radius -= this.radiusDecay;

    if (this.radius < blackHoleRadius) {
      this.radius = initialOrbitRadius + Math.random() * 50;
      this.trail = [];
      this.relativeTrail = [];
    }

    const relX = Math.cos(this.angle) * this.radius;
    const relY = Math.sin(this.angle) * this.radius;

    this.relativeTrail.unshift({ x: relX, y: relY });
    if (this.relativeTrail.length > this.trailLength) {
      this.relativeTrail.pop();
    }

    this.trail = this.relativeTrail.map(point => ({
      x: this.blackHoleX + point.x,
      y: this.blackHoleY + point.y,
    }));
  }

  draw() {
    if (this.trail.length < 2) return;

    const gradientTrail = ctx.createLinearGradient(
      this.trail[0].x,
      this.trail[0].y,
      this.trail[this.trail.length - 1].x,
      this.trail[this.trail.length - 1].y
    );
    gradientTrail.addColorStop(0, this.color);
    gradientTrail.addColorStop(1, 'rgba(255, 255, 255, 0)');

    ctx.beginPath();
    ctx.moveTo(this.trail[0].x, this.trail[0].y);

    for (let i = 1; i < this.trail.length; i++) {
      const point = this.trail[i];
      const cp1x = (this.trail[i - 1].x + point.x) / 2;
      const cp1y = (this.trail[i - 1].y + point.y) / 2;
      if (i === 1) {
        ctx.quadraticCurveTo(cp1x, cp1y, point.x, point.y);
      } else {
        const prevPoint = this.trail[i - 1];
        ctx.bezierCurveTo(
          this.trail[i - 2].x,
          this.trail[i - 2].y,
          cp1x,
          cp1y,
          point.x,
          point.y
        );
      }
    }

    ctx.strokeStyle = gradientTrail;
    ctx.lineWidth = this.size;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
    ctx.stroke();

    ctx.fillStyle = this.color;
    ctx.beginPath();
    ctx.arc(this.trail[0].x, this.trail[0].y, this.size, 0, Math.PI * 2);
    ctx.fill();
  }
}

function initParticles() {
  particles.length = 0;
  for (let i = 0; i < particleCount; i++) {
    const p = new Particle();
    particles.push(p);
  }
}

function drawGlow(cx, cy) {
  const glowGradient = ctx.createRadialGradient(
    cx,
    cy,
    blackHoleRadius,
    cx,
    cy,
    glowRadius * 3
  );
  glowGradient.addColorStop(0, 'rgba(255, 255, 255, 0.6)');
  glowGradient.addColorStop(0.8, 'rgba(100, 100, 100, 0.2)');
  glowGradient.addColorStop(1, 'rgba(0, 0, 0, 0)');

  ctx.fillStyle = glowGradient;
  ctx.beginPath();
  ctx.arc(cx, cy, glowRadius * 3, 0, Math.PI * 2);
  ctx.fill();
}

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const relativeHoleX = screenCenterX - window.screenX;
  const relativeHoleY = screenCenterY - window.screenY;

  const isWindowMoved =
    Math.abs(relativeHoleX - lastHoleX) > 2 ||
    Math.abs(relativeHoleY - lastHoleY) > 2;

  const isHoleVisible =
    relativeHoleX > -blackHoleRadius * 4 &&
    relativeHoleX < canvas.width + blackHoleRadius * 4 &&
    relativeHoleY > -blackHoleRadius * 4 &&
    relativeHoleY < canvas.height + blackHoleRadius * 4;

  if (isHoleVisible) {
    drawGlow(relativeHoleX, relativeHoleY);

    ctx.fillStyle = '#000';
    ctx.beginPath();
    ctx.arc(relativeHoleX, relativeHoleY, blackHoleRadius, 0, Math.PI * 2);
    ctx.fill();

    if (centerImage.complete) {
      ctx.drawImage(
        centerImage,
        relativeHoleX - imageSizeX / 2,
        relativeHoleY - imageSizeY / 2,
        imageSizeX,
        imageSizeY
      );
    }

    particles.forEach(p => {
      p.blackHoleX = relativeHoleX;
      p.blackHoleY = relativeHoleY;
      if (isWindowMoved) {
        p.relativeTrail = [];
      }
      p.update();
      p.draw();
    });
  }

  lastHoleX = relativeHoleX;
  lastHoleY = relativeHoleY;

  requestAnimationFrame(animate);
}

window.onload = function () {
  initParticles();
  animate();
};
document.oncontextmenu = function () {
  return false;
};
document.addEventListener('keydown', function (e) {
  if (e.key === 'F12') {
    e.preventDefault();
  }
  if (e.ctrlKey && e.key === 'u') {
    e.preventDefault();
  }
});
```


```js
// 检查保护层状态
function checkShieldStatus() {
  const shield = document.getElementById('shieldOverlay');
  const button = document.getElementById('accessButton');

  if (!shield) {
    button.classList.add('active');
    button.disabled = false;
  } else {
    button.classList.remove('active');
    button.disabled = true;
  }
}

checkShieldStatus();

setInterval(checkShieldStatus, 500);

document.getElementById('accessButton').addEventListener('click', function () {
  if (!document.getElementById('shieldOverlay')) {
    document.getElementById('nextLevelForm').submit();
  }
});

document.addEventListener('contextmenu', function (e) {
  e.preventDefault();
});

(function () {
  document.addEventListener('keydown', function (e) {
    // F12
    if (e.keyCode === 123) {
      e.preventDefault();
      showDevToolsWarning();
    }
    // Ctrl+Shift+I (Windows/Linux)
    if (e.ctrlKey && e.shiftKey && e.keyCode === 73) {
      e.preventDefault();
      showDevToolsWarning();
    }
    // Ctrl+Shift+J (Windows/Linux)
    if (e.ctrlKey && e.shiftKey && e.keyCode === 74) {
      e.preventDefault();
      showDevToolsWarning();
    }
    // Cmd+Option+I (Mac)
    if (e.metaKey && e.altKey && e.keyCode === 73) {
      e.preventDefault();
      showDevToolsWarning();
    }
    // Cmd+Option+J (Mac)
    if (e.metaKey && e.altKey && e.keyCode === 74) {
      e.preventDefault();
      showDevToolsWarning();
    }
    // Ctrl+U (查看源代码)
    if (e.ctrlKey && e.keyCode === 85) {
      e.preventDefault();
      showDevToolsWarning();
    }
  });

  let devtools = false;
  const threshold = 160;

  function checkDevTools() {
    const widthThreshold = window.outerWidth - window.innerWidth > threshold;
    const heightThreshold = window.outerHeight - window.innerHeight > threshold;
    const orientation = widthThreshold ? 'vertical' : 'horizontal';

    if (
      !(heightThreshold && widthThreshold) &&
      ((window.Firebug &&
        window.Firebug.chrome &&
        window.Firebug.chrome.isInitialized) ||
        widthThreshold ||
        heightThreshold)
    ) {
      devtools = true;
      showDevToolsWarning();
    } else {
      devtools = false;
    }
  }

  setInterval(checkDevTools, 1000);

  function showDevToolsWarning() {
    const warning = document.getElementById('devToolsWarning');
    warning.style.display = 'flex';

    document.addEventListener('keydown', function closeWarning(e) {
      if (e.key === 'Escape') {
        warning.style.display = 'none';
        document.removeEventListener('keydown', closeWarning);
      }
    });
  }

  if (typeof console !== 'undefined') {
    if (typeof console.log !== 'undefined') {
      console.log = function () {};
    }
    if (typeof console.warn !== 'undefined') {
      console.warn = function () {};
    }
    if (typeof console.error !== 'undefined') {
      console.error = function () {};
    }
    if (typeof console.info !== 'undefined') {
      console.info = function () {};
    }
  }
})();
```

